{"ast":null,"code":"import _toConsumableArray from \"/mnt/c/Users/enton/Workspace/cnr/build/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/mnt/c/Users/enton/Workspace/cnr/build/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/mnt/c/Users/enton/Workspace/cnr/build/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/mnt/c/Users/enton/Workspace/cnr/build/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/mnt/c/Users/enton/Workspace/cnr/build/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as React from \"react\";\nimport { useEffect } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { connect } from 'react-redux';\nimport { Typography } from \"@material-ui/core\";\nimport Lightbox from \"react-image-lightbox\";\nimport { CloudDownload as IconDownload } from \"@material-ui/icons\";\nimport Spinner from \"../../components/spinner/spinner\";\nimport PageContainer from \"../../components/page/pageContainer\";\nimport { MorphologyCard } from \"../../components/cards/morphologyCard\";\nimport { ElectrophysiologyCard } from \"../../components/cards/electrophysiologyCard\";\nimport { ConnectionCard } from \"../../components/cards/connectionCard\";\nimport { CustomButton } from \"../../components/buttons/buttons\";\nimport { clear, setMorphology, removeModFile, removeElectrophysiology, addElectrophysiology } from \"../../actions/hodgkinHuxley.actions\";\nimport { getFilters, searchDatasets, downloadAllDatasets, downloadDatasets, checkMorphologyForShow } from \"../../helpers/apiHelper\";\nimport { FormFilter } from \"../../components/forms/filter\";\nimport constants from \"../../constants\";\nimport pageContentStyle from '../page.module.scss';\nimport { ItemsCountBaloon } from \"../../components/baloons/itemsCountBaloon\";\nimport { MorphologyViewerDialog } from \"../../components/dialogs/morphologyViewerDialog\";\nimport { HodgkinHuxleyBaloon } from \"../../components/hodgkin-huxley-baloon\";\nimport { AgreeDownloadDialog } from \"../../components/dialogs/agreeDownloadDialog\";\nimport { downloadFile } from \"../../helpers/downloadHelper\";\nimport 'react-image-lightbox/style.css';\nimport { AlertDialog } from \"../../components/dialogs/alertDialog\";\nimport { hashCode } from \"../../helpers/hashHelper\";\nimport { dataTypes } from \"../../constants/constants\";\nvar _typeCards = {\n  'morphology': MorphologyCard,\n  'electrophysiology': ElectrophysiologyCard,\n  'connection': ConnectionCard\n};\n\nvar lightboxStyles = function lightboxStyles() {\n  var _window$pageYOffset, _window;\n\n  return {\n    content: {\n      top: ((_window$pageYOffset = (_window = window) === null || _window === void 0 ? void 0 : _window.pageYOffset) !== null && _window$pageYOffset !== void 0 ? _window$pageYOffset : 0) > 60 ? 0 : 60\n    }\n  };\n};\n\nvar neurmorphoSource = 'neuromorpho';\n\nvar _DataPage = function _DataPage(props) {\n  var _page$variant;\n\n  var _React$useState = React.useState(true),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      loading = _React$useState2[0],\n      setLoading = _React$useState2[1];\n\n  var _React$useState3 = React.useState({}),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      page = _React$useState4[0],\n      setPage = _React$useState4[1];\n\n  var _React$useState5 = React.useState([]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      dataSets = _React$useState6[0],\n      setDataSets = _React$useState6[1];\n\n  var _React$useState7 = React.useState(null),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      filters = _React$useState8[0],\n      setFilters = _React$useState8[1];\n\n  var _React$useState9 = React.useState(null),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      selectedFilters = _React$useState10[0],\n      setSelectedFilters = _React$useState10[1];\n\n  var _React$useState11 = React.useState(''),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      selectedQuery = _React$useState12[0],\n      setSelectedQuery = _React$useState12[1];\n\n  var _React$useState13 = React.useState([]),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      selectedForDownloads = _React$useState14[0],\n      setSelectedForDownloads = _React$useState14[1];\n\n  var _React$useState15 = React.useState(0),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      numPage = _React$useState16[0],\n      setNumPage = _React$useState16[1];\n\n  var _React$useState17 = React.useState(1),\n      _React$useState18 = _slicedToArray(_React$useState17, 2),\n      totalPages = _React$useState18[0],\n      setTotalPages = _React$useState18[1];\n\n  var _React$useState19 = React.useState(0),\n      _React$useState20 = _slicedToArray(_React$useState19, 2),\n      totalItems = _React$useState20[0],\n      setTotalItems = _React$useState20[1];\n\n  var _React$useState21 = React.useState(constants.DEFAULT_HITS_PER_PAGE),\n      _React$useState22 = _slicedToArray(_React$useState21, 2),\n      hitsPerPage = _React$useState22[0],\n      setHitsPerPage = _React$useState22[1];\n\n  var _React$useState23 = React.useState(false),\n      _React$useState24 = _slicedToArray(_React$useState23, 2),\n      openMorphologyViewer = _React$useState24[0],\n      setOpenMorphologyViewer = _React$useState24[1];\n\n  var _React$useState25 = React.useState(false),\n      _React$useState26 = _slicedToArray(_React$useState25, 2),\n      openAgreeDownloadDialog = _React$useState26[0],\n      setOpenAgreeDownloadDialog = _React$useState26[1];\n\n  var _React$useState27 = React.useState(null),\n      _React$useState28 = _slicedToArray(_React$useState27, 2),\n      selectedMorphologyViewerModel = _React$useState28[0],\n      setSelectedMorphologyViewerModel = _React$useState28[1];\n\n  var acceptDownloadCallback = React.useRef(function () {\n    return null;\n  });\n\n  var _React$useState29 = React.useState(false),\n      _React$useState30 = _slicedToArray(_React$useState29, 2),\n      openAlertDialog = _React$useState30[0],\n      setOpenAlertDialog = _React$useState30[1];\n\n  var _React$useState31 = React.useState(null),\n      _React$useState32 = _slicedToArray(_React$useState31, 2),\n      alertDialogMessage = _React$useState32[0],\n      setAlertDialogMessage = _React$useState32[1];\n\n  var _React$useState33 = React.useState(null),\n      _React$useState34 = _slicedToArray(_React$useState33, 2),\n      lightboxImg = _React$useState34[0],\n      setLightboxImg = _React$useState34[1];\n\n  var params = props.params,\n      selectedMorphologyForBuilding = props.selectedMorphologyForBuilding,\n      selectedElectrophysiologiesForBuilding = props.selectedElectrophysiologiesForBuilding,\n      selectedModFilesForBuilding = props.selectedModFilesForBuilding,\n      setMorphologyForBuilding = props.setMorphologyForBuilding,\n      addElectrophysiologyForBuilding = props.addElectrophysiologyForBuilding,\n      removeElectrophysiologyForBuilding = props.removeElectrophysiologyForBuilding,\n      removeModFileForBuilding = props.removeModFileForBuilding,\n      clearHodgkinHuxley = props.clearHodgkinHuxley;\n  var router = useRouter();\n  useEffect(function () {\n    setup();\n  }, []);\n  useEffect(function () {\n    if (!openMorphologyViewer) {\n      setSelectedMorphologyViewerModel(null);\n    }\n  }, [openMorphologyViewer]);\n\n  var setup = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _url$searchParams, _query$trim, url, query, _filters, _params$type, _params$type2, _yield$searchDatasets, _totalPages, _totalItems, items;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              //const _page = await getPage('data');\n              url = new URL(window.location.href);\n              query = url === null || url === void 0 ? void 0 : (_url$searchParams = url.searchParams) === null || _url$searchParams === void 0 ? void 0 : _url$searchParams.get('query');\n              _context.next = 5;\n              return getFilters({\n                indexName: 'dataset',\n                type: params === null || params === void 0 ? void 0 : params.type\n              });\n\n            case 5:\n              _filters = _context.sent;\n\n              if (!(!!query && (query === null || query === void 0 ? void 0 : (_query$trim = query.trim()) === null || _query$trim === void 0 ? void 0 : _query$trim.length) > 0)) {\n                _context.next = 12;\n                break;\n              }\n\n              setSelectedQuery(query);\n              _context.next = 10;\n              return _search({\n                data_type: (_params$type = params === null || params === void 0 ? void 0 : params.type) !== null && _params$type !== void 0 ? _params$type : null,\n                query: query,\n                filters: selectedFilters,\n                page: numPage\n              });\n\n            case 10:\n              _context.next = 21;\n              break;\n\n            case 12:\n              _context.next = 14;\n              return searchDatasets({\n                data_type: (_params$type2 = params === null || params === void 0 ? void 0 : params.type) !== null && _params$type2 !== void 0 ? _params$type2 : null,\n                query: selectedQuery,\n                filters: selectedFilters,\n                page: numPage\n              });\n\n            case 14:\n              _yield$searchDatasets = _context.sent;\n              _totalPages = _yield$searchDatasets.total_page;\n              _totalItems = _yield$searchDatasets.total;\n              items = _yield$searchDatasets.items;\n              setTotalPages(_totalPages);\n              setTotalItems(_totalItems);\n              setDataSets(items);\n\n            case 21:\n              setFilters(_filters);\n              setLoading(false);\n              _context.next = 27;\n              break;\n\n            case 25:\n              _context.prev = 25;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 25]]);\n    }));\n\n    return function setup() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var _onChangeFilters = function _onChangeFilters(key, value) {\n    if (!!key) {\n      var _selectedFilters$pref;\n\n      if (key.split('.').length === 1) {\n        setSelectedFilters(_objectSpread(_objectSpread({}, selectedFilters), {}, _defineProperty({}, key, value)));\n        return;\n      }\n\n      var prefixKey = key.split('.')[0];\n      var itemKey = key.split('.')[1];\n      var prefixKeyValue = !!selectedFilters ? (_selectedFilters$pref = selectedFilters[prefixKey]) !== null && _selectedFilters$pref !== void 0 ? _selectedFilters$pref : {} : {};\n      setSelectedFilters(_objectSpread(_objectSpread({}, selectedFilters), {}, _defineProperty({}, prefixKey, _objectSpread(_objectSpread({}, prefixKeyValue), {}, _defineProperty({}, itemKey, value)))));\n    }\n  };\n\n  var _onChangeQuery = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(query) {\n      var _query$trim2;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setSelectedQuery(query);\n\n              if (!((query === null || query === void 0 ? void 0 : (_query$trim2 = query.trim()) === null || _query$trim2 === void 0 ? void 0 : _query$trim2.length) < constants.MIN_SEARCH_LENGTH)) {\n                _context2.next = 4;\n                break;\n              }\n\n              _context2.next = 4;\n              return _search({\n                query: query\n              });\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function _onChangeQuery(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var _search = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var _params$type3;\n\n      var _ref4,\n          query,\n          filters,\n          hitsPerPage,\n          page,\n          _filters,\n          _yield$searchDatasets2,\n          _totalPages,\n          _totalItems,\n          items,\n          _args3 = arguments;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _ref4 = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {}, query = _ref4.query, filters = _ref4.filters, hitsPerPage = _ref4.hitsPerPage;\n              console.log('@@@@requestSearch');\n              page = 0;\n              setNumPage(0);\n              setLoading(true);\n              _filters = filters !== undefined ? filters : selectedFilters;\n              _context3.next = 8;\n              return searchDatasets({\n                data_type: (_params$type3 = params === null || params === void 0 ? void 0 : params.type) !== null && _params$type3 !== void 0 ? _params$type3 : null,\n                query: query !== null && query !== void 0 ? query : selectedQuery,\n                filters: _filters,\n                page: page,\n                hitsPerPage: hitsPerPage\n              });\n\n            case 8:\n              _yield$searchDatasets2 = _context3.sent;\n              _totalPages = _yield$searchDatasets2.total_page;\n              _totalItems = _yield$searchDatasets2.total;\n              items = _yield$searchDatasets2.items;\n              console.log('@@@@@@@totalPages', _totalPages);\n              console.log('@@@@@@@totalItems', _totalItems);\n              setDataSets(items);\n              setTotalPages(_totalPages);\n              setTotalItems(_totalItems);\n              setLoading(false);\n\n            case 18:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function _search() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var _loadMore = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var _params$type4;\n\n      var page, _yield$searchDatasets3, _totalPages, _totalItems, items, allDataSets;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              page = numPage + 1;\n              setNumPage(page);\n              setLoading(true);\n              _context4.next = 5;\n              return searchDatasets({\n                data_type: (_params$type4 = params === null || params === void 0 ? void 0 : params.type) !== null && _params$type4 !== void 0 ? _params$type4 : null,\n                query: selectedQuery,\n                filters: selectedFilters,\n                hitsPerPage: hitsPerPage,\n                page: page\n              });\n\n            case 5:\n              _yield$searchDatasets3 = _context4.sent;\n              _totalPages = _yield$searchDatasets3.total_page;\n              _totalItems = _yield$searchDatasets3.total;\n              items = _yield$searchDatasets3.items;\n              allDataSets = [].concat(_toConsumableArray(dataSets), _toConsumableArray(items));\n              setDataSets(allDataSets);\n              setTotalItems(_totalItems);\n              setTotalPages(_totalPages);\n              setLoading(false);\n\n            case 14:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function _loadMore() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var _onHitsPerPageChange = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(value) {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              setHitsPerPage(value);\n              _context5.next = 3;\n              return _search({\n                hitsPerPage: value\n              });\n\n            case 3:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function _onHitsPerPageChange(_x2) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var _applyFilters = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return _search();\n\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function _applyFilters() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var _resetFilters = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              setSelectedFilters(null);\n              _context7.next = 3;\n              return _search({\n                query: '',\n                filters: null\n              });\n\n            case 3:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function _resetFilters() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var _downloadAll = function _downloadAll() {\n    _askForDownload({\n      all: true,\n      callback: function callback() {\n        window.open(downloadAllDatasets(params === null || params === void 0 ? void 0 : params.type));\n      }\n    });\n  };\n\n  var _downloadSelectedDatasets = function _downloadSelectedDatasets() {\n    _askForDownload({\n      all: true,\n      callback: function callback() {\n        window.open(downloadDatasets(selectedForDownloads));\n      }\n    });\n  };\n\n  var _openMorphologyViewer = /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(_ref9) {\n      var modelName, modelUrl, detailPage;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              modelName = _ref9.modelName, modelUrl = _ref9.modelUrl, detailPage = _ref9.detailPage;\n              _context8.next = 3;\n              return checkMorphologyForShow(modelUrl);\n\n            case 3:\n              if (_context8.sent) {\n                _context8.next = 7;\n                break;\n              }\n\n              _openAlertDialog(\"The current morphology cannot be visualized in this viewer.<br/>Please visit the source <a href=\\\"\".concat(detailPage, \"\\\" target=\\\"_blank\\\">web page</a> of the morphology for further details.\"));\n\n              _context8.next = 9;\n              break;\n\n            case 7:\n              setSelectedMorphologyViewerModel({\n                modelName: modelName,\n                modelUrl: modelUrl\n              });\n              setOpenMorphologyViewer(true);\n\n            case 9:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function _openMorphologyViewer(_x3) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  var _closeMorphologyViewer = function _closeMorphologyViewer() {\n    setOpenMorphologyViewer(false);\n  };\n\n  var _openAlertDialog = function _openAlertDialog(message) {\n    setOpenAlertDialog(true);\n    setAlertDialogMessage(message);\n    return;\n  };\n\n  var _closeAlertDialog = function _closeAlertDialog() {\n    setOpenAlertDialog(false);\n    setAlertDialogMessage(null);\n  };\n\n  var _onCloseLightBox = function _onCloseLightBox() {\n    setLightboxImg(null);\n  };\n\n  var _toggleSelectForDownload = /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(id, selected) {\n      var newValues, _newValues, elIndex;\n\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              console.log('@@@@@@@toggleSelectForDownload', id, selected);\n\n              if (selected) {\n                newValues = _toConsumableArray(selectedForDownloads);\n                newValues.push(id);\n                setSelectedForDownloads(newValues);\n              } else {\n                _newValues = _toConsumableArray(selectedForDownloads);\n                elIndex = _newValues.indexOf(id);\n\n                if (elIndex > -1) {\n                  _newValues.splice(elIndex, 1);\n\n                  setSelectedForDownloads(_newValues);\n                }\n              }\n\n            case 2:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n\n    return function _toggleSelectForDownload(_x4, _x5) {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var _toggleElectrophysiologyForBuilding = function _toggleElectrophysiologyForBuilding(selectedItem) {\n    var index = (selectedElectrophysiologiesForBuilding !== null && selectedElectrophysiologiesForBuilding !== void 0 ? selectedElectrophysiologiesForBuilding : []).findIndex(function (item) {\n      return hashCode(JSON.stringify(selectedItem)) === hashCode(JSON.stringify(item));\n    });\n\n    if (index === -1) {\n      addElectrophysiologyForBuilding(selectedItem);\n    } else {\n      removeElectrophysiologyForBuilding(selectedItem);\n    }\n  };\n\n  var _selectForModelBuilding = function _selectForModelBuilding(item) {\n    if (!!item) {\n      if ((item === null || item === void 0 ? void 0 : item.type) === dataTypes.morphology) {\n        setMorphologyForBuilding(!!item ? {\n          name: item === null || item === void 0 ? void 0 : item.name,\n          url: item === null || item === void 0 ? void 0 : item.download_link\n        } : null);\n      } else if ((item === null || item === void 0 ? void 0 : item.type) === dataTypes.electrophysiology) {\n        var _item$metadata;\n\n        _toggleElectrophysiologyForBuilding({\n          name: item === null || item === void 0 ? void 0 : item.name,\n          url: item === null || item === void 0 ? void 0 : item.download_link,\n          metadata: (_item$metadata = item === null || item === void 0 ? void 0 : item.metadata) !== null && _item$metadata !== void 0 ? _item$metadata : null\n        });\n      }\n    }\n  };\n\n  var _askForDownload = function _askForDownload(_ref12) {\n    var url = _ref12.url,\n        callback = _ref12.callback,\n        source = _ref12.source,\n        _ref12$all = _ref12.all,\n        all = _ref12$all === void 0 ? false : _ref12$all;\n\n    if (!!source && (source === null || source === void 0 ? void 0 : source.toLowerCase()) === neurmorphoSource || all) {\n      if (!!url && url.trim().length > 0) {\n        acceptDownloadCallback.current = function () {\n          return downloadFile(url);\n        };\n      } else if (!!callback) {\n        acceptDownloadCallback.current = callback;\n      }\n\n      setOpenAgreeDownloadDialog(true);\n    } else {\n      if (!!url && url.trim().length > 0) {\n        downloadFile(url);\n      } else if (!!callback) {\n        callback();\n      }\n    }\n  };\n\n  var _acceptDownloadCallback = function _acceptDownloadCallback() {\n    setOpenAgreeDownloadDialog(false);\n\n    if (!!(acceptDownloadCallback === null || acceptDownloadCallback === void 0 ? void 0 : acceptDownloadCallback.current)) {\n      acceptDownloadCallback === null || acceptDownloadCallback === void 0 ? void 0 : acceptDownloadCallback.current();\n      acceptDownloadCallback.current = null;\n    }\n  };\n\n  var _cancelDownloadCallback = function _cancelDownloadCallback() {\n    setOpenAgreeDownloadDialog(false);\n\n    if (!!(acceptDownloadCallback === null || acceptDownloadCallback === void 0 ? void 0 : acceptDownloadCallback.current)) {\n      acceptDownloadCallback.current = null;\n    }\n  };\n\n  var _getDataTypeLabel = function _getDataTypeLabel(type) {\n    var _constants$DATA_TYPE_;\n\n    return (_constants$DATA_TYPE_ = constants.DATA_TYPE_LABELS[type]) !== null && _constants$DATA_TYPE_ !== void 0 ? _constants$DATA_TYPE_ : type;\n  };\n\n  var hasMoreItems = numPage < totalPages - 1;\n  var hasData = !!dataSets && dataSets.length > 0;\n  var hasDownloadableFiles = !!dataSets && dataSets.length > 0 && dataSets.filter(function (item) {\n    return !!item.download_link;\n  }).length > 0;\n  var CardType = _typeCards[params === null || params === void 0 ? void 0 : params.type];\n  var countBaloonClassName = !!hasDownloadableFiles && !!selectedForDownloads && selectedForDownloads.length > 0 ? 'col-md-6' : 'col-md-8';\n  var downloadBlockClassName = !!hasDownloadableFiles && !!selectedForDownloads && selectedForDownloads.length > 0 ? 'col-md-6' : 'col-md-4';\n  var pageVariant = (_page$variant = page === null || page === void 0 ? void 0 : page.variant) !== null && _page$variant !== void 0 ? _page$variant : 'dark';\n  return __jsx(PageContainer, {\n    variant: pageVariant,\n    mainClassName: 'with-fixed-header',\n    fixedHeader: true\n  }, __jsx(\"div\", {\n    className: \"container \".concat(pageContentStyle['page-container'])\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(Typography, {\n    variant: \"h4\",\n    className: pageContentStyle['page-header-label']\n  }, \"DATA > \".concat(_getDataTypeLabel(params === null || params === void 0 ? void 0 : params.type))))), __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, page === null || page === void 0 ? void 0 : page.content)), __jsx(\"section\", null, __jsx(\"div\", {\n    className: \"row\",\n    style: {\n      marginTop: 20\n    }\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormFilter, {\n    variant: pageVariant,\n    query: selectedQuery,\n    filters: filters,\n    selectedFilters: selectedFilters,\n    selectedHitsPerPage: hitsPerPage,\n    onQueryChange: function onQueryChange(value) {\n      return _onChangeQuery(value);\n    },\n    onRequestSearch: function onRequestSearch() {\n      return _search();\n    },\n    onChangeHitsPerPage: function onChangeHitsPerPage(value) {\n      return _onHitsPerPageChange(value);\n    },\n    onChangeFilters: function onChangeFilters(key, value) {\n      return _onChangeFilters(key, value);\n    },\n    applyFilters: function applyFilters() {\n      return _applyFilters();\n    },\n    resetFilters: function resetFilters() {\n      return _resetFilters();\n    }\n  }))), __jsx(\"div\", {\n    className: \"row\",\n    style: {\n      marginTop: 20\n    }\n  }, __jsx(\"div\", {\n    className: countBaloonClassName\n  }, __jsx(ItemsCountBaloon, {\n    label: \"Total items\",\n    count: totalItems\n  })), __jsx(\"div\", {\n    className: \"\".concat(downloadBlockClassName, \" text-right\")\n  }, !!selectedForDownloads && selectedForDownloads.length > 0 ? __jsx(CustomButton, {\n    onClick: function onClick() {\n      return _downloadSelectedDatasets();\n    },\n    style: {\n      \"float\": 'right',\n      marginRight: 10,\n      fontSize: 16\n    }\n  }, __jsx(IconDownload, null), \" \", __jsx(\"span\", {\n    style: {\n      marginLeft: 5\n    }\n  }, \"Download Selected\")) : null)), __jsx(\"div\", {\n    className: \"row\",\n    style: {\n      marginTop: 20\n    }\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(HodgkinHuxleyBaloon, {\n    variant: pageVariant,\n    morphology: selectedMorphologyForBuilding,\n    electrophysiologies: selectedElectrophysiologiesForBuilding,\n    modFiles: selectedModFilesForBuilding,\n    removeMorphology: function removeMorphology() {\n      return setMorphologyForBuilding(null);\n    },\n    removeElectrophysiology: function removeElectrophysiology(item) {\n      return removeElectrophysiologyForBuilding(item);\n    },\n    removeModFile: function removeModFile(item) {\n      return removeModFileForBuilding(item);\n    },\n    clear: function clear() {\n      return clearHodgkinHuxley();\n    }\n  }))), __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-12 text-center\"\n  }, !hasData ? __jsx(\"p\", null, loading ? '' : 'There are not data for search criteria') : __jsx(\"div\", null, (dataSets !== null && dataSets !== void 0 ? dataSets : []).map(function (item) {\n    return __jsx(\"div\", {\n      className: \"row\",\n      key: \"row-dataset-\".concat(item === null || item === void 0 ? void 0 : item.id)\n    }, __jsx(\"div\", {\n      className: \"col-12\"\n    }, __jsx(CardType, {\n      onClick: function onClick() {\n        return null;\n      },\n      dataSet: item,\n      selectedForDownload: selectedForDownloads.includes(item['source_id']),\n      toggleSelectedForDownload: _toggleSelectForDownload,\n      openMorphologyViewer: _openMorphologyViewer,\n      openImageLightbox: function openImageLightbox(url) {\n        return setLightboxImg(url);\n      },\n      closImageLightbox: function closImageLightbox() {\n        return setLightboxImg(null);\n      },\n      selectForModelBuilder: _selectForModelBuilding,\n      askForDownload: _askForDownload\n    })));\n  })))), hasMoreItems ? __jsx(\"div\", {\n    className: \"row\",\n    style: {\n      marginTop: 20\n    }\n  }, __jsx(\"div\", {\n    className: \"col-12 text-center\"\n  }, __jsx(CustomButton, {\n    variant: \"primary\",\n    style: {\n      margin: '0 auto',\n      fontSize: 16\n    },\n    onClick: function onClick() {\n      return _loadMore();\n    }\n  }, \"Load More\"))) : null), loading ? __jsx(Spinner, null) : null), __jsx(AlertDialog, {\n    open: openAlertDialog,\n    onClose: _closeAlertDialog,\n    message: alertDialogMessage\n  }), __jsx(MorphologyViewerDialog, {\n    open: openMorphologyViewer,\n    onClose: _closeMorphologyViewer,\n    modelName: selectedMorphologyViewerModel === null || selectedMorphologyViewerModel === void 0 ? void 0 : selectedMorphologyViewerModel.modelName,\n    modelUrl: selectedMorphologyViewerModel === null || selectedMorphologyViewerModel === void 0 ? void 0 : selectedMorphologyViewerModel.modelUrl\n  }), !!lightboxImg ? __jsx(Lightbox, {\n    mainSrc: lightboxImg,\n    reactModalStyle: lightboxStyles(),\n    onCloseRequest: _onCloseLightBox\n  }) : null, __jsx(AgreeDownloadDialog, {\n    open: openAgreeDownloadDialog,\n    pageUrl: 'https://facility-hub.cineca.it/neuro_morpho/useterm.jsp',\n    acceptDownloadCallback: _acceptDownloadCallback,\n    cancelDownloadCallback: _cancelDownloadCallback\n  }));\n};\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n  var _state$hodgkinHuxley$, _state$hodgkinHuxley, _state$hodgkinHuxley$2, _state$hodgkinHuxley2, _state$hodgkinHuxley$3, _state$hodgkinHuxley3;\n\n  return {\n    selectedMorphologyForBuilding: (_state$hodgkinHuxley$ = state === null || state === void 0 ? void 0 : (_state$hodgkinHuxley = state.hodgkinHuxley) === null || _state$hodgkinHuxley === void 0 ? void 0 : _state$hodgkinHuxley.morphology) !== null && _state$hodgkinHuxley$ !== void 0 ? _state$hodgkinHuxley$ : null,\n    selectedElectrophysiologiesForBuilding: (_state$hodgkinHuxley$2 = state === null || state === void 0 ? void 0 : (_state$hodgkinHuxley2 = state.hodgkinHuxley) === null || _state$hodgkinHuxley2 === void 0 ? void 0 : _state$hodgkinHuxley2.electrophysiologies) !== null && _state$hodgkinHuxley$2 !== void 0 ? _state$hodgkinHuxley$2 : null,\n    selectedModFilesForBuilding: (_state$hodgkinHuxley$3 = state === null || state === void 0 ? void 0 : (_state$hodgkinHuxley3 = state.hodgkinHuxley) === null || _state$hodgkinHuxley3 === void 0 ? void 0 : _state$hodgkinHuxley3.modFiles) !== null && _state$hodgkinHuxley$3 !== void 0 ? _state$hodgkinHuxley$3 : []\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    setMorphologyForBuilding: function setMorphologyForBuilding(item) {\n      return dispatch(setMorphology(item));\n    },\n    addElectrophysiologyForBuilding: function addElectrophysiologyForBuilding(item) {\n      return dispatch(addElectrophysiology(item));\n    },\n    removeElectrophysiologyForBuilding: function removeElectrophysiologyForBuilding(item) {\n      return dispatch(removeElectrophysiology(item));\n    },\n    removeModFileForBuilding: function removeModFileForBuilding(item) {\n      return dispatch(removeModFile(item));\n    },\n    clearHodgkinHuxley: function clearHodgkinHuxley() {\n      return dispatch(clear());\n    }\n  };\n};\n\nexport var __N_SSG = true;\nexport default connect(mapStateToProps, mapDispatchToProps)(_DataPage);","map":null,"metadata":{},"sourceType":"module"}